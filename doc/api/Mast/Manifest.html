<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: Mast::Manifest</title>

  
    <link rel="SHORTCUT ICON" href="../assets/icon/class.png">
  

  <link type="text/css" rel="stylesheet" href="../assets/rdoc.css" media="screen" />
  <link type="text/css" rel="stylesheet" href="../assets/highlight/styles/github.css" title="GitHub" />

  <script type="text/javascript" charset="utf-8" src="../assets/jquery.js"></script>
  <script type="text/javascript" charset="utf-8" src="../assets/highlight/highlight.pack.js"></script>
  <script type="text/javascript" charset="utf-8" src="../assets/quicksearch.js"></script>
  <script type="text/javascript" charset="utf-8" src="../assets/main.js"></script>

  <script type="text/javascript">
    $(document).ready( function() {
      $('#documentation pre').wrapInner('<code></code>');
      hljs.tabReplace = '    ';
      hljs.initHighlightingOnLoad('ruby');

	    hookSourceViews();
	    hookDebuggingToggle();
	    hookQuickSearch();
	    highlightLocationTarget();

	    $('ul.link-list a').bind( "click", highlightClickTarget );
    });
  </script>
</head>
<body class="class">
<div id="main">

  <div class="head">
    <h1>
      
        <img src="../assets/icon/class.png" align="absmiddle">&nbsp;
      
      <a href="../index.html">&quot;Mast&quot;</a>&nbsp;
      <a href="/">Mast::Manifest</a>
    </h1>
  </div>

  <div id="metadata">
    <div id="project-metadata">

      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li class="file"><a href="../lib/mast/manifest_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/mast/manifest.rb">lib/mast/manifest.rb</a></li>
          
          </ul>
        </div>
      </div>

      <!-- What about Git info, or Hg info? This seems almost silly, albeit kind of cool. -->
      <!-- TODO: generalize this for all SCMs -->

      
    </div>

    <div id="class-metadata">

      <!-- Parent Class -->
      
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        <ul>
          
            
              <li class="class">Object</li>
            
          
        </ul>
      </div>
      

      <!-- Namespace Contents -->
      

      <!-- Method Quickref -->
      
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
            
            <li class="singleton">
              <a href="#method-c-new">::new</a>
            </li>
          
            
            <li class="singleton">
              <a href="#method-c-open">::open</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-change_options">#change_options</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-changed-3F">#changed?</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-chart">#chart</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-clean">#clean</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-cleanlist">#cleanlist</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-diff">#diff</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-filechart">#filechart</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-filelist">#filelist</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-filename">#filename</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-generate">#generate</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-list">#list</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-list_without_folders">#list_without_folders</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-listing">#listing</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-read-3F">#read?</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-save">#save</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-showlist">#showlist</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-to_s">#to_s</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-unlisted">#unlisted</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-update">#update</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-verify">#verify</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-whatsnew">#whatsnew</a>
            </li>
          
            
            <li class="method">
              <a href="#method-i-whatsold">#whatsold</a>
            </li>
          
        </ul>
      </div>
      

      <!-- Included Modules -->
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Information</h3>
        <ul>
        
          <li class="file"><a href="../PROFILE.html">PROFILE</a></li>
        
          <li class="file"><a href="../HISTORY_rdoc.html">HISTORY.rdoc</a></li>
        
          <li class="file"><a href="../LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="../VERSION.html">VERSION</a></li>
        
          <li class="file"><a href="../README_rdoc.html">README.rdoc</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class Index
          <span class="search-toggle"><img src="../assets/icon/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <!-- classpage.html : classes -->
        <ul class="link-list">
        
          <li class="module"><a href="../Mast.html">Mast</a></li>
        
          <li class="class"><a href="../Mast/Cli.html">Mast::Cli</a></li>
        
          <li class="class"><a href="../Mast/Manifest.html">Mast::Manifest</a></li>
        
          <li class="module"><a href="../Syckle.html">Syckle</a></li>
        
          <li class="module"><a href="../Syckle/Plugins.html">Syckle::Plugins</a></li>
        
          <li class="class"><a href="../Syckle/Plugins/Mast.html">Syckle::Plugins::Mast</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>
    </div>

    <div id="validator-badges">
      
      <div style="float: right; margin-right: 5px;">
        <a href="http://validator.w3.org/check/referer"><img src="../assets/icon/check.png" alt="[Validate]" height="16" width="16" /></a>
      </div>
      Generated with <a href="http://rubyworks.github.com/newfish">Newfish</a> 0.2.0
      <br/><br/>
    </div>
  </div>

  <div id="documentation">

    <div id="description">
      
        <h1>Manifest</h1>
      

      
<p><a href="Manifest.html">Manifest</a> stores a list of package files, and
optionally checksums.</p>

<p>The class can be used to create and compare package manifests and digests.</p>

<p>TODO: Integrate file signing and general manifest better (?)</p>

<p>TODO: Digester is in sign.rb too. Dry-up?</p>

<p>TODO: The <a href="Manifest.html#method-i-diff">diff</a> method is shelling
out; this needs to be internalized.</p>

<p>TODO: Consider adding @include options rather then scanning entire
directory. But this can’t be done unless we can write a routine that can
look at @include and reduce it to non-overlapping matches. Eg. [doc,
doc/rdoc] should reduce to just [doc]. Otherwise we will get duplicate
entries, b/c the #output method is written for speed and low memory
footprint. This might mean @include can’t use file globs.</p>

    </div>

    <!-- Constants -->
    
    <div id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt><a name="OverwriteError">OverwriteError</a></dt>
        
        <dd class="description"><p><a href="Manifest.html">Manifest</a> file overwrite error.</p></dd>
        
      
        <dt><a name="NoManifestError">NoManifestError</a></dt>
        
        <dd class="description"><p>No <a href="Manifest.html">Manifest</a> File Error.</p></dd>
        
      
        <dt><a name="DEFAULT_EXCLUDE">DEFAULT_EXCLUDE</a></dt>
        
        <dd class="description"><p>By default mast will exclude any pathname matching ‘CVS’, ‘_darcs’,
‘.git*’ or ‘.config’.</p></dd>
        
      
        <dt><a name="DEFAULT_IGNORE">DEFAULT_IGNORE</a></dt>
        
        <dd class="description"><p>By default, mast will ignore any file with a name matching ‘.svn’ or
‘*~’, ie. ending with a tilde.</p></dd>
        
      
        <dt><a name="DEFAULT_FILE">DEFAULT_FILE</a></dt>
        
        <dd class="description"></dd>
        
      
      </dl>
    </div>
    

    <!-- Attributes -->
    
    <div id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="directory-attribute-method" class="method-detail">
        <a name="directory"></a>
        
        <a name="directory="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">directory</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Directory of manifest.</p>
        
        </div>
      </div>
      
      <div id="file-attribute-method" class="method-detail">
        <a name="file"></a>
        
        <a name="file="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">file</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>File used to store manifest/digest file.</p>
        
        </div>
      </div>
      
      <div id="digest-attribute-method" class="method-detail">
        <a name="digest"></a>
        
        <a name="digest="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">digest</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Encryption type</p>
        
        </div>
      </div>
      
      <div id="all-attribute-method" class="method-detail">
        <a name="all"></a>
        
        <a name="all="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">all</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Do not exclude standard exclusions.</p>
        
        </div>
      </div>
      
      <div id="dir-attribute-method" class="method-detail">
        <a name="dir"></a>
        
        <a name="dir="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">dir</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Include directories.</p>
        
        </div>
      </div>
      
      <div id="bang-attribute-method" class="method-detail">
        <a name="bang"></a>
        
        <a name="bang="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">bang</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Show as if another manifest (i.e. use file’s bang options).</p>
        
        </div>
      </div>
      
      <div id="include-attribute-method" class="method-detail">
        <a name="include"></a>
        
        <a name="include="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">include</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>What files to include. Defaults to [‘*’]. Note that <a
href="../Mast.html">Mast</a> automatically recurses through directory
entries, so using ‘*<b>/</b>’ would simply be a waste of of processing
cycles.</p>
        
        </div>
      </div>
      
      <div id="exclude-attribute-method" class="method-detail">
        <a name="exclude"></a>
        
        <a name="exclude="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">exclude</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>What files to exclude.</p>
        
        </div>
      </div>
      
      <div id="ignore-attribute-method" class="method-detail">
        <a name="ignore"></a>
        
        <a name="ignore="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">ignore</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Special files to ignore.</p>
        
        </div>
      </div>
      
      <div id="format-attribute-method" class="method-detail">
        <a name="format"></a>
        
        <a name="format="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">format</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Layout of digest – ‘csf’ or ‘sfv’. Default is ‘csf’.</p>
        
        </div>
      </div>
      
      <div id="all-3F-attribute-method" class="method-detail">
        <a name="all?"></a>
        
        <a name="all?="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">all?</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Do not exclude standard exclusions.</p>
        
        </div>
      </div>
      
      <div id="dir-3F-attribute-method" class="method-detail">
        <a name="dir?"></a>
        
        <a name="dir?="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">dir?</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Include directories.</p>
        
        </div>
      </div>
      
      <div id="bang-3F-attribute-method" class="method-detail">
        <a name="bang?"></a>
        
        <a name="bang?="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">bang?</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Show as if another manifest (i.e. use file’s bang options).</p>
        
        </div>
      </div>
      
    </div>
    

    <!-- Methods -->
    
    <div id="public-class-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="new-method" class="method-detail ">
        <a name="method-c-new"></a>

        <div class="method-heading">
        
          <span class="method-name">new</span><span
            class="method-args">(options={})</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>New <a href="Manifest.html">Manifest</a> object.</p>
          

          
          <div class="method-source-code"
            id="new-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 106</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span>={})
  <span class="ruby-ivar">@include</span>   = [<span class="ruby-string">'*'</span>]
  <span class="ruby-ivar">@exclude</span>   = []
  <span class="ruby-ivar">@ignore</span>    = []
  <span class="ruby-ivar">@format</span>    = <span class="ruby-string">'csf'</span>
  <span class="ruby-ivar">@all</span>       = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@dir</span>       = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@bang</span>      = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@digest</span>    = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@directory</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>

  <span class="ruby-identifier">change_options</span>(<span class="ruby-identifier">options</span>)

  <span class="ruby-comment">#if @file</span>
  <span class="ruby-comment">#  read(@file)</span>
  <span class="ruby-comment">#else</span>
    <span class="ruby-comment">#if file = Dir.glob(self.class.filename)[0]</span>
    <span class="ruby-comment">#  @file = file</span>
    <span class="ruby-comment">#else</span>
  <span class="ruby-comment">#    @file = DEFAULT_FILE</span>
    <span class="ruby-comment">#end</span>
  <span class="ruby-comment">#end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="open-method" class="method-detail ">
        <a name="method-c-open"></a>

        <div class="method-heading">
        
          <span class="method-name">open</span><span
            class="method-args">(file=nil, options={})</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <pre>Possible file name (was for Fileable?).</pre>

<p>def self.filename</p>

<pre>DEFAULT_FILE</pre>

<p>end</p>
          

          
          <div class="method-source-code"
            id="open-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span>={})
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">file</span>
    <span class="ruby-identifier">file</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">FNM_CASEFOLD</span>).<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoManifestError</span>, <span class="ruby-string">&quot;Manifest file is required.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">file</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:file</span>] = <span class="ruby-identifier">file</span>
  <span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
    </div>
  
    <div id="public-instance-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="change_options-method" class="method-detail ">
        <a name="method-i-change_options"></a>

        <div class="method-heading">
        
          <span class="method-name">change_options</span><span
            class="method-args">(opts)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Set options.</p>
          

          
          <div class="method-source-code"
            id="change_options-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_options</span>(<span class="ruby-identifier">opts</span>)
  <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">k</span> = <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span>
    <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{k}=&quot;</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">||</span><span class="ruby-identifier">send</span>(<span class="ruby-identifier">k</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment">#@file       = options[:file]    || @file</span>
  <span class="ruby-comment">#@digest     = options[:digest]  || @digest</span>
  <span class="ruby-comment">#@all        = options[:all]     || @all</span>
  <span class="ruby-comment">#@exclude    = options[:exclude] || options[:ignore] || @exclude</span>
  <span class="ruby-comment">#@exclude    = [@exclude].flatten.compact</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="changed-3F-method" class="method-detail ">
        <a name="method-i-changed-3F"></a>

        <div class="method-heading">
        
          <span class="method-name">changed?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Is the current mainfest in need of updating?</p>
          

          
          <div class="method-source-code"
            id="changed-3F-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 158</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">changed?</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoManifestError</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">file</span> <span class="ruby-keyword">and</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">file</span>)
  <span class="ruby-identifier">txt</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">file</span>)
  <span class="ruby-identifier">out</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment">#('', 'w')</span>
  <span class="ruby-identifier">generate</span>(<span class="ruby-identifier">out</span>)
  <span class="ruby-identifier">out</span>.<span class="ruby-identifier">string</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">txt</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="chart-method" class="method-detail ">
        <a name="method-i-chart"></a>

        <div class="method-heading">
        
          <span class="method-name">chart</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Chart of current files (name =&gt; checksum).</p>
          

          
          <div class="method-source-code"
            id="chart-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 251</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">chart</span>
  <span class="ruby-ivar">@chart</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">parse_directory</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="clean-method" class="method-detail ">
        <a name="method-i-clean"></a>

        <div class="method-heading">
        
          <span class="method-name">clean</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Clean non-manifest files.</p>
          

          
          <div class="method-source-code"
            id="clean-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 235</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clean</span>
  <span class="ruby-identifier">cfiles</span>, <span class="ruby-identifier">cdirs</span> = <span class="ruby-identifier">cleanlist</span>.<span class="ruby-identifier">partition</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">f</span>) }
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">cfiles</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cdirs</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">$stderr</span> <span class="ruby-operator">&lt;</span> <span class="ruby-string">&quot;No difference between list and actual.\n&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">cfiles</span>)
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rmdir</span>(<span class="ruby-identifier">cdirs</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="cleanlist-method" class="method-detail ">
        <a name="method-i-cleanlist"></a>

        <div class="method-heading">
        
          <span class="method-name">cleanlist</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="cleanlist-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 266</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cleanlist</span>
  <span class="ruby-identifier">showlist</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">filelist</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="diff-method" class="method-detail ">
        <a name="method-i-diff"></a>

        <div class="method-heading">
        
          <span class="method-name">diff</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Diff file against actual files.</p>

<p>TODO: Do not shell out for diff.</p>
          

          
          <div class="method-source-code"
            id="diff-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 202</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">diff</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoManifestError</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">file</span> <span class="ruby-keyword">and</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">file</span>)
  <span class="ruby-identifier">parse_topline</span> <span class="ruby-comment"># parse_file unless read?</span>
  <span class="ruby-identifier">manifest</span> = <span class="ruby-identifier">create_temporary_manifest</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-node">`diff -du #{file} #{manifest.file}`</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">manifest</span>.<span class="ruby-identifier">file</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># pass = result.empty?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="filechart-method" class="method-detail ">
        <a name="method-i-filechart"></a>

        <div class="method-heading">
        
          <span class="method-name">filechart</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Chart of files as given in MANIFEST file (name =&gt; checksum).</p>
          

          
          <div class="method-source-code"
            id="filechart-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 261</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">filechart</span>
  <span class="ruby-ivar">@filechart</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">parse_file</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="filelist-method" class="method-detail ">
        <a name="method-i-filelist"></a>

        <div class="method-heading">
        
          <span class="method-name">filelist</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>List of files as given in MANIFEST file.</p>
          

          
          <div class="method-source-code"
            id="filelist-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 256</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">filelist</span>
  <span class="ruby-ivar">@filelist</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">filechart</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="filename-method" class="method-detail ">
        <a name="method-i-filename"></a>

        <div class="method-heading">
        
          <span class="method-name">filename</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>File’s basename.</p>
          

          
          <div class="method-source-code"
            id="filename-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 300</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">filename</span>
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">file</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="generate-method" class="method-detail ">
        <a name="method-i-generate"></a>

        <div class="method-heading">
        
          <span class="method-name">generate</span><span
            class="method-args">(out=$stdout)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Generate manifest.</p>
          

          
          <div class="method-source-code"
            id="generate-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 176</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">generate</span>(<span class="ruby-identifier">out</span>=<span class="ruby-identifier">$stdout</span>)
  <span class="ruby-identifier">parse_topline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">read?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">bang?</span>
  <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">topline_string</span>
  <span class="ruby-identifier">output</span>(<span class="ruby-identifier">out</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="list-method" class="method-detail ">
        <a name="method-i-list"></a>

        <div class="method-heading">
        
          <span class="method-name">list</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>List of current files.</p>
          

          
          <div class="method-source-code"
            id="list-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 246</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">list</span>
  <span class="ruby-ivar">@list</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">chart</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="list_without_folders-method" class="method-detail ">
        <a name="method-i-list_without_folders"></a>

        <div class="method-heading">
        
          <span class="method-name">list_without_folders</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>List of files in file system, but omit folders.</p>
          

          
          <div class="method-source-code"
            id="list_without_folders-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 401</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">list_without_folders</span>
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">f</span>) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="listing-method" class="method-detail ">
        <a name="method-i-listing"></a>

        <div class="method-heading">
        
          <span class="method-name">listing</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Produce textual listing less the manifest file.</p>
          

          
          <div class="method-source-code"
            id="listing-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 407</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">listing</span>
  <span class="ruby-identifier">str</span> = <span class="ruby-string">''</span>
  <span class="ruby-identifier">output</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-identifier">str</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="read-3F-method" class="method-detail ">
        <a name="method-i-read-3F"></a>

        <div class="method-heading">
        
          <span class="method-name">read?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="read-3F-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read?</span>
  <span class="ruby-ivar">@read</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="save-method" class="method-detail ">
        <a name="method-i-save"></a>

        <div class="method-heading">
        
          <span class="method-name">save</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Save as file.</p>
          

          
          <div class="method-source-code"
            id="save-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save</span>
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-string">'w'</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">file</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">topline_string</span>
    <span class="ruby-identifier">output</span>(<span class="ruby-identifier">file</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">file</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="showlist-method" class="method-detail ">
        <a name="method-i-showlist"></a>

        <div class="method-heading">
        
          <span class="method-name">showlist</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="showlist-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 280</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">showlist</span>
  <span class="ruby-identifier">parse_topline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">read?</span>
  <span class="ruby-identifier">list</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="to_s-method" class="method-detail ">
        <a name="method-i-to_s"></a>

        <div class="method-heading">
        
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="to_s-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 414</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">topline_string</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">listing</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="unlisted-method" class="method-detail ">
        <a name="method-i-unlisted"></a>

        <div class="method-heading">
        
          <span class="method-name">unlisted</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Files not listed in manifest.</p>
          

          
          <div class="method-source-code"
            id="unlisted-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 271</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unlisted</span>
  <span class="ruby-identifier">list</span> = []
  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">directory</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">list</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-string">'**/*'</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">list</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">filelist</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="update-method" class="method-detail ">
        <a name="method-i-update"></a>

        <div class="method-heading">
        
          <span class="method-name">update</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Update file.</p>
          

          
          <div class="method-source-code"
            id="update-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 183</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoManifestError</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">file</span> <span class="ruby-keyword">and</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">file</span>)
  <span class="ruby-identifier">parse_topline</span>
  <span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="verify-method" class="method-detail ">
        <a name="method-i-verify"></a>

        <div class="method-heading">
        
          <span class="method-name">verify</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="verify-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">verify</span>
  <span class="ruby-identifier">parse_file</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">read?</span>
  <span class="ruby-identifier">chart</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">filechart</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="whatsnew-method" class="method-detail ">
        <a name="method-i-whatsnew"></a>

        <div class="method-heading">
        
          <span class="method-name">whatsnew</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Files found in file system, but not listed in the manifest file.</p>
          

          
          <div class="method-source-code"
            id="whatsnew-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 223</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">whatsnew</span>
  <span class="ruby-identifier">parse_file</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">read?</span>
  <span class="ruby-identifier">list</span> <span class="ruby-operator">-</span> (<span class="ruby-identifier">filelist</span> <span class="ruby-operator">+</span> [<span class="ruby-identifier">filename</span>])
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="whatsold-method" class="method-detail ">
        <a name="method-i-whatsold"></a>

        <div class="method-heading">
        
          <span class="method-name">whatsold</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>Files listed in the manifest file, but not found in file system.</p>
          

          
          <div class="method-source-code"
            id="whatsold-source">
<pre>
<span class="ruby-comment"># File lib/mast/manifest.rb, line 217</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">whatsold</span>
  <span class="ruby-identifier">parse_file</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">read?</span>
  <span class="ruby-identifier">filelist</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">list</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
    </div>
  

  </div>


  <div id="rdoc-debugging-section-dump" class="debugging-section">
  
    <p>Disabled; run with --debug to generate this.</p>
  
  </div>

</main>
</body>
</html>

