<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

  <title>Class: Mast::Manifest</title>

  
    <link rel="SHORTCUT ICON" href="../../assets/icon/class.png">
  

  <link type="text/css" rel="stylesheet" href="../../assets/rdoc.css" media="screen" />
  <link type="text/css" rel="stylesheet" href="../../assets/highlight/styles/github.css" title="GitHub" />

  <script type="text/javascript" charset="utf-8" src="../../assets/jquery.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../assets/highlight/highlight.pack.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../assets/quicksearch.js"></script>
  <script type="text/javascript" charset="utf-8" src="../../assets/main.js"></script>

  <script type="text/javascript">
    $(document).ready( function() {
      hookHighlightSyntax();
	    hookSourceViews();
	    hookDebuggingToggle();
	    hookQuickSearch();
	    highlightLocationTarget();

	    $('ul.link-list a').bind("click", highlightClickTarget);
    });
  </script>
</head>
<body class="class">
<div id="main">

  <div class="head">
    <h1>
      
        <img src="../../assets/icon/class.png" align="absmiddle">&nbsp;
      
      <a href="../../index.html">Mast</a>&nbsp;
      <a href="/">Mast::Manifest</a>
    </h1>
  </div>

  <div id="metadata">
    <div id="project-metadata">

      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li class="file"><a href="../../files/lib/mast/manifest_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/mast/manifest.rb">lib/mast/manifest.rb</a></li>
          
          </ul>
        </div>
      </div>

      <!-- What about Git info, or Hg info? This seems almost silly, albeit kind of cool. -->
      <!-- TODO: generalize this for all SCMs -->

      
    </div>

    <div id="class-metadata">

      <!-- Parent Class -->
      
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        <ul>
          
          <li class="class">Object</li>
          
        </ul>
      </div>
      

      <!-- Namespace Contents -->
      

      <!-- Method Quickref -->
      
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
            
            <li class="singleton">
              <a href="#M000013">::new</a>
            </li>
          
            
            <li class="singleton">
              <a href="#M000012">::open</a>
            </li>
          
            
            <li class="method">
              <a href="#M000015">#change_options</a>
            </li>
          
            
            <li class="method">
              <a href="#M000041">#chart</a>
            </li>
          
            
            <li class="method">
              <a href="#M000072">#checksum</a>
            </li>
          
            
            <li class="method">
              <a href="#M000037">#clean</a>
            </li>
          
            
            <li class="method">
              <a href="#M000047">#cleanlist</a>
            </li>
          
            
            <li class="method">
              <a href="#M000071">#create_temporary_manifest</a>
            </li>
          
            
            <li class="method">
              <a href="#M000028">#diff</a>
            </li>
          
            
            <li class="method">
              <a href="#M000073">#digester</a>
            </li>
          
            
            <li class="method">
              <a href="#M000066">#exclusions</a>
            </li>
          
            
            <li class="method">
              <a href="#M000018">#file</a>
            </li>
          
            
            <li class="method">
              <a href="#M000046">#filechart</a>
            </li>
          
            
            <li class="method">
              <a href="#M000045">#filelist</a>
            </li>
          
            
            <li class="method">
              <a href="#M000051">#filename</a>
            </li>
          
            
            <li class="method">
              <a href="#M000064">#files</a>
            </li>
          
            
            <li class="method">
              <a href="#M000025">#generate</a>
            </li>
          
            
            <li class="method">
              <a href="#M000067">#ignores</a>
            </li>
          
            
            <li class="method">
              <a href="#M000017">#include=</a>
            </li>
          
            
            <li class="method">
              <a href="#M000065">#inclusions</a>
            </li>
          
            
            <li class="method">
              <a href="#M000040">#list</a>
            </li>
          
            
            <li class="method">
              <a href="#M000068">#list_without_folders</a>
            </li>
          
            
            <li class="method">
              <a href="#M000069">#listing</a>
            </li>
          
            
            <li class="method">
              <a href="#M000053">#output</a>
            </li>
          
            
            <li class="method">
              <a href="#M000063">#parse_directory</a>
            </li>
          
            
            <li class="method">
              <a href="#M000074">#parse_file</a>
            </li>
          
            
            <li class="method">
              <a href="#M000075">#parse_topline</a>
            </li>
          
            
            <li class="method">
              <a href="#M000022">#read?</a>
            </li>
          
            
            <li class="method">
              <a href="#M000076">#read_topline</a>
            </li>
          
            
            <li class="method">
              <a href="#M000054">#rec_output</a>
            </li>
          
            
            <li class="method">
              <a href="#M000027">#save</a>
            </li>
          
            
            <li class="method">
              <a href="#M000049">#showlist</a>
            </li>
          
            
            <li class="method">
              <a href="#M000070">#to_s</a>
            </li>
          
            
            <li class="method">
              <a href="#M000077">#topline_string</a>
            </li>
          
            
            <li class="method">
              <a href="#M000048">#unlisted</a>
            </li>
          
            
            <li class="method">
              <a href="#M000026">#update</a>
            </li>
          
            
            <li class="method">
              <a href="#M000036">#verify</a>
            </li>
          
            
            <li class="method">
              <a href="#M000034">#whatsnew</a>
            </li>
          
            
            <li class="method">
              <a href="#M000033">#whatsold</a>
            </li>
          
        </ul>
      </div>
      

      <!-- Included Modules -->
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Information</h3>
        <ul>
        
          <li class="file"><a href="../../files/HISTORY_rdoc.html">HISTORY.rdoc</a></li>
        
          <li class="file"><a href="../../files/LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="../../files/README_rdoc.html">README.rdoc</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class Index
          <span class="search-toggle"><img src="../../assets/icon/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <!-- classpage.html : classes -->
        <ul class="link-list">
        
          <li class="module"><a href="../../classes/Mast.html">Mast</a></li>
        
          <li class="class"><a href="../../classes/Mast/Cli.html">Mast::Cli</a></li>
        
          <li class="class"><a href="../../classes/Mast/Manifest.html">Mast::Manifest</a></li>
        
          <li class="module"><a href="../../classes/Syckle.html">Syckle</a></li>
        
          <li class="module"><a href="../../classes/Syckle/Plugins.html">Syckle::Plugins</a></li>
        
          <li class="class"><a href="../../classes/Syckle/Plugins/Mast.html">Syckle::Plugins::Mast</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>
    </div>

    <div id="validator-badges">
      
      <div style="float: right; margin-right: 5px;">
        <a href="http://validator.w3.org/check/referer"><img src="../../assets/icon/check.png" alt="[Validate]" height="16" width="16" /></a>
      </div>
      Generated with <a href="http://github.com/proutils/webri">WebRI Redfish</a> 1.1
      <br/><br/>
    </div>
  </div>

  <div id="documentation">

    <div id="description">
      
        <h1>Manifest</h1>
      

      <p>
<a href="Manifest.html">Manifest</a> stores a list of package files, and
optionally checksums.
</p>
<p>
The class can be used to create and compare package manifests and digests.
</p>
<p>
TODO: Integrate file signing and general manifest better (?)
</p>
<p>
TODO: Digester is in sign.rb too. Dry-up?
</p>
<p>
TODO: The <a href="Manifest.html#M000028">diff</a> method is shelling out;
this needs to be internalized.
</p>
<p>
TODO: Consider adding @include options rather then scanning entire
directory. But this can&#8217;t be done unless we can write a routine that
can look at @include and reduce it to non-overlapping matches. Eg. [doc,
doc/rdoc] should reduce to just [doc]. Otherwise we will get duplicate
entries, b/c the <a href="Manifest.html#M000053">output</a> method is
written for speed and low memory footprint. This might mean @include
can&#8217;t use file globs.
</p>

    </div>

    <!-- Constants -->
    
    <div id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt><a name="OverwriteError">OverwriteError</a></dt>
        
        <dd class="description"><p>
<a href="Manifest.html">Manifest</a> file overwrite error.
</p></dd>
        
      
        <dt><a name="NoManifestError">NoManifestError</a></dt>
        
        <dd class="description"><p>
No <a href="Manifest.html">Manifest</a> File Error.
</p></dd>
        
      
        <dt><a name="DEFAULT_EXCLUDE">DEFAULT_EXCLUDE</a></dt>
        
        <dd class="description"><p>
By default mast will exclude any pathname matching &#8216;CVS&#8217;,
&#8216;_darcs&#8217;, &#8217;.git*&#8217; or &#8217;.config&#8217;.
</p></dd>
        
      
        <dt><a name="DEFAULT_IGNORE">DEFAULT_IGNORE</a></dt>
        
        <dd class="description"><p>
By default, mast will ignore any file with a name matching
&#8217;.svn&#8217; or &#8217;*~&#8217;, ie. ending with a tilde.
</p></dd>
        
      
        <dt><a name="DEFAULT_FILE">DEFAULT_FILE</a></dt>
        
        <dd class="description"></dd>
        
      
      </dl>
    </div>
    

    <!-- Attributes -->
    
    <div id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="directory-attribute-method" class="method-detail">
        <a name="directory"></a>
        
        <a name="directory="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">directory</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
Directory of manifest.
</p>
        
        </div>
      </div>
      
      <div id="file-attribute-method" class="method-detail">
        <a name="file"></a>
        
        <a name="file="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">file</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
File used to store manifest/digest file.
</p>
        
        </div>
      </div>
      
      <div id="digest-attribute-method" class="method-detail">
        <a name="digest"></a>
        
        <a name="digest="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">digest</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
Encryption type
</p>
        
        </div>
      </div>
      
      <div id="all-attribute-method" class="method-detail">
        <a name="all"></a>
        
        <a name="all="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">all</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
Do not exclude standard exclusions.
</p>
        
        </div>
      </div>
      
      <div id="dir-attribute-method" class="method-detail">
        <a name="dir"></a>
        
        <a name="dir="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">dir</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
Include directories.
</p>
        
        </div>
      </div>
      
      <div id="show-attribute-method" class="method-detail">
        <a name="show"></a>
        
        <a name="show="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">show</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
Show as if another manifest (eg. use files options). TODO: Change name?
</p>
        
        </div>
      </div>
      
      <div id="include-attribute-method" class="method-detail">
        <a name="include"></a>
        
        <a name="include="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">include</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
What files to include. Defaults to [&#8217;*&#8217;]. Note that <a
href="../Mast.html">Mast</a> automatically recurses through directory
entries, so using &#8217;*<b>/</b>&#8217; would simply be a waste of of
processing cycles.
</p>
        
        </div>
      </div>
      
      <div id="exclude-attribute-method" class="method-detail">
        <a name="exclude"></a>
        
        <a name="exclude="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">exclude</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
What files to exclude.
</p>
        
        </div>
      </div>
      
      <div id="ignore-attribute-method" class="method-detail">
        <a name="ignore"></a>
        
        <a name="ignore="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">ignore</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
Special files to ignore.
</p>
        
        </div>
      </div>
      
      <div id="format-attribute-method" class="method-detail">
        <a name="format"></a>
        
        <a name="format="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">format</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>
Layout of digest &#8212; &#8216;csf&#8217; or &#8216;sfv&#8217;. Default is
&#8216;csf&#8217;.
</p>
        
        </div>
      </div>
      
    </div>
    

    <!-- Methods -->
    
    <div id="public-class-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="new-method" class="method-detail ">
        <a name="M000013"></a>

        <div class="method-heading">
        
          <span class="method-name">new</span><span
            class="method-args">(options={})</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
New <a href="Manifest.html">Manifest</a> object.
</p>
          

          
          <div class="method-source-code"
            id="new-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 107</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span>={})
      <span class="ruby-ivar">@include</span>   = [<span class="ruby-value str">'*'</span>]
      <span class="ruby-ivar">@exclude</span>   = []
      <span class="ruby-ivar">@ignore</span>    = []
      <span class="ruby-ivar">@format</span>    = <span class="ruby-value str">'csf'</span>
      <span class="ruby-ivar">@all</span>       = <span class="ruby-keyword kw">false</span>
      <span class="ruby-ivar">@dir</span>       = <span class="ruby-keyword kw">false</span>
      <span class="ruby-ivar">@show</span>      = <span class="ruby-keyword kw">false</span>
      <span class="ruby-ivar">@digest</span>    = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-ivar">@directory</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>

      <span class="ruby-identifier">change_options</span>(<span class="ruby-identifier">options</span>)

      <span class="ruby-comment cmt">#if @file</span>
      <span class="ruby-comment cmt">#  read(@file)</span>
      <span class="ruby-comment cmt">#else</span>
        <span class="ruby-comment cmt">#if file = Dir.glob(self.class.filename)[0]</span>
        <span class="ruby-comment cmt">#  @file = file</span>
        <span class="ruby-comment cmt">#else</span>
      <span class="ruby-comment cmt">#    @file = DEFAULT_FILE</span>
        <span class="ruby-comment cmt">#end</span>
      <span class="ruby-comment cmt">#end</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="open-method" class="method-detail ">
        <a name="M000012"></a>

        <div class="method-heading">
        
          <span class="method-name">open</span><span
            class="method-args">(file=nil, options={})</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <pre>
 Possible file name (was for Fileable?).
</pre>
<p>
def self.filename
</p>
<pre>
  DEFAULT_FILE
</pre>
<p>
end
</p>
          

          
          <div class="method-source-code"
            id="open-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 50</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span>={})
      <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">file</span>
        <span class="ruby-identifier">file</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">FNM_CASEFOLD</span>).<span class="ruby-identifier">first</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoManifestError</span>, <span class="ruby-value str">&quot;Manifest file is required.&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">file</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:file</span>] = <span class="ruby-identifier">file</span>
      <span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>)
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
    </div>
  
    <div id="public-instance-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="change-options-method" class="method-detail ">
        <a name="M000015"></a>

        <div class="method-heading">
        
          <span class="method-name">change_options</span><span
            class="method-args">(opts)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Set options.
</p>
          

          
          <div class="method-source-code"
            id="change-options-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 132</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_options</span>(<span class="ruby-identifier">opts</span>)
      <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">k</span> = <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span>
        <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{k}=&quot;</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">||</span><span class="ruby-identifier">send</span>(<span class="ruby-identifier">k</span>))
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-comment cmt">#@file       = options[:file]    || @file</span>
      <span class="ruby-comment cmt">#@digest     = options[:digest]  || @digest</span>
      <span class="ruby-comment cmt">#@all        = options[:all]     || @all</span>
      <span class="ruby-comment cmt">#@exclude    = options[:exclude] || options[:ignore] || @exclude</span>
      <span class="ruby-comment cmt">#@exclude    = [@exclude].flatten.compact</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="chart-method" class="method-detail ">
        <a name="M000041"></a>

        <div class="method-heading">
        
          <span class="method-name">chart</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Chart of current files (name => checksum).
</p>
          

          
          <div class="method-source-code"
            id="chart-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 243</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">chart</span>
      <span class="ruby-ivar">@chart</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">parse_directory</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="clean-method" class="method-detail ">
        <a name="M000037"></a>

        <div class="method-heading">
        
          <span class="method-name">clean</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Clean non-manifest files.
</p>
          

          
          <div class="method-source-code"
            id="clean-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 227</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clean</span>
      <span class="ruby-identifier">cfiles</span>, <span class="ruby-identifier">cdirs</span> = <span class="ruby-identifier">cleanlist</span>.<span class="ruby-identifier">partition</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">f</span>) }
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cfiles</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cdirs</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">$stderr</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value str">&quot;No difference between list and actual.\n&quot;</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">cfiles</span>)
        <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rmdir</span>(<span class="ruby-identifier">cdirs</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="cleanlist-method" class="method-detail ">
        <a name="M000047"></a>

        <div class="method-heading">
        
          <span class="method-name">cleanlist</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="cleanlist-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 258</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cleanlist</span>
      <span class="ruby-identifier">showlist</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">filelist</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="diff-method" class="method-detail ">
        <a name="M000028"></a>

        <div class="method-heading">
        
          <span class="method-name">diff</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Diff file against actual files.
</p>
<p>
TODO: Do not shell out for diff.
</p>
          

          
          <div class="method-source-code"
            id="diff-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 194</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">diff</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoManifestError</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">file</span> <span class="ruby-keyword kw">and</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">file</span>)
      <span class="ruby-identifier">parse_topline</span> <span class="ruby-comment cmt"># parse_file unless read?</span>
      <span class="ruby-identifier">manifest</span> = <span class="ruby-identifier">create_temporary_manifest</span>
      <span class="ruby-keyword kw">begin</span>
        <span class="ruby-identifier">result</span> = <span class="ruby-node">`diff -du #{file} #{manifest.file}`</span>
      <span class="ruby-keyword kw">ensure</span>
        <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">manifest</span>.<span class="ruby-identifier">file</span>)
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-comment cmt"># pass = result.empty?</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="file-method" class="method-detail ">
        <a name="M000018"></a>

        <div class="method-heading">
        
          <span class="method-name">file</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="file-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 149</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">file</span>
      <span class="ruby-ivar">@file</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">directory</span>, <span class="ruby-constant">DEFAULT_FILE</span>), <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">FNM_CASEFOLD</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'MANIFEST'</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="filechart-method" class="method-detail ">
        <a name="M000046"></a>

        <div class="method-heading">
        
          <span class="method-name">filechart</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Chart of files as given in MANIFEST file (name => checksum).
</p>
          

          
          <div class="method-source-code"
            id="filechart-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 253</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">filechart</span>
      <span class="ruby-ivar">@filechart</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">parse_file</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="filelist-method" class="method-detail ">
        <a name="M000045"></a>

        <div class="method-heading">
        
          <span class="method-name">filelist</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
List of files as given in MANIFEST file.
</p>
          

          
          <div class="method-source-code"
            id="filelist-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 248</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">filelist</span>
      <span class="ruby-ivar">@filelist</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">filechart</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="filename-method" class="method-detail ">
        <a name="M000051"></a>

        <div class="method-heading">
        
          <span class="method-name">filename</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
File&#8217;s basename.
</p>
          

          
          <div class="method-source-code"
            id="filename-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 292</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">filename</span>
      <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">file</span>)
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="generate-method" class="method-detail ">
        <a name="M000025"></a>

        <div class="method-heading">
        
          <span class="method-name">generate</span><span
            class="method-args">(out=$stdout)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Generate manifest.
</p>
          

          
          <div class="method-source-code"
            id="generate-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 168</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generate</span>(<span class="ruby-identifier">out</span>=<span class="ruby-identifier">$stdout</span>)
      <span class="ruby-identifier">parse_topline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">read?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">show?</span>
      <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">topline_string</span>
      <span class="ruby-identifier">output</span>(<span class="ruby-identifier">out</span>)
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="include--method" class="method-detail ">
        <a name="M000017"></a>

        <div class="method-heading">
        
          <span class="method-name">include=</span><span
            class="method-args">(inc)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p class="missing-docs">(Not documented)</p>
          

          
          <div class="method-source-code"
            id="include--source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 144</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">include=</span>(<span class="ruby-identifier">inc</span>)
      <span class="ruby-ivar">@include</span> = [<span class="ruby-identifier">inc</span>].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="list-method" class="method-detail ">
        <a name="M000040"></a>

        <div class="method-heading">
        
          <span class="method-name">list</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
List of current files.
</p>
          

          
          <div class="method-source-code"
            id="list-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 238</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list</span>
      <span class="ruby-ivar">@list</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">chart</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="list-without-folders-method" class="method-detail ">
        <a name="M000068"></a>

        <div class="method-heading">
        
          <span class="method-name">list_without_folders</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
List of files in file system, but omit folders.
</p>
          

          
          <div class="method-source-code"
            id="list-without-folders-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 393</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_without_folders</span>
      <span class="ruby-identifier">list</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">f</span>) }
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="listing-method" class="method-detail ">
        <a name="M000069"></a>

        <div class="method-heading">
        
          <span class="method-name">listing</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Produce textual listing less the manifest file.
</p>
          

          
          <div class="method-source-code"
            id="listing-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 399</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">listing</span>
      <span class="ruby-identifier">str</span> = <span class="ruby-value str">''</span>
      <span class="ruby-identifier">output</span>(<span class="ruby-identifier">str</span>)
      <span class="ruby-identifier">str</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="read--method" class="method-detail ">
        <a name="M000022"></a>

        <div class="method-heading">
        
          <span class="method-name">read?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="read--source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 154</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read?</span>
      <span class="ruby-ivar">@read</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="save-method" class="method-detail ">
        <a name="M000027"></a>

        <div class="method-heading">
        
          <span class="method-name">save</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Save as file.
</p>
          

          
          <div class="method-source-code"
            id="save-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 182</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save</span>
      <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-value str">'w'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">file</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">topline_string</span>
        <span class="ruby-identifier">output</span>(<span class="ruby-identifier">file</span>)
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">file</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="showlist-method" class="method-detail ">
        <a name="M000049"></a>

        <div class="method-heading">
        
          <span class="method-name">showlist</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="showlist-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 272</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">showlist</span>
      <span class="ruby-identifier">parse_topline</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">read?</span>
      <span class="ruby-identifier">list</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="to-s-method" class="method-detail ">
        <a name="M000070"></a>

        <div class="method-heading">
        
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="to-s-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 406</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">topline_string</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">listing</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="unlisted-method" class="method-detail ">
        <a name="M000048"></a>

        <div class="method-heading">
        
          <span class="method-name">unlisted</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Files not listed in manifest.
</p>
          

          
          <div class="method-source-code"
            id="unlisted-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 263</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unlisted</span>
      <span class="ruby-identifier">list</span> = []
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">directory</span>) <span class="ruby-keyword kw">do</span>
        <span class="ruby-identifier">list</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-value str">'**/*'</span>)
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">list</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">filelist</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="update-method" class="method-detail ">
        <a name="M000026"></a>

        <div class="method-heading">
        
          <span class="method-name">update</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Update file.
</p>
          

          
          <div class="method-source-code"
            id="update-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 175</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoManifestError</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">file</span> <span class="ruby-keyword kw">and</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">file</span>)
      <span class="ruby-identifier">parse_topline</span>
      <span class="ruby-identifier">save</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="verify-method" class="method-detail ">
        <a name="M000036"></a>

        <div class="method-heading">
        
          <span class="method-name">verify</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="verify-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 221</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">verify</span>
      <span class="ruby-identifier">parse_file</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">read?</span>
      <span class="ruby-identifier">chart</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">filechart</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="whatsnew-method" class="method-detail ">
        <a name="M000034"></a>

        <div class="method-heading">
        
          <span class="method-name">whatsnew</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Files found in file system, but not listed in the manifest file.
</p>
          

          
          <div class="method-source-code"
            id="whatsnew-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 215</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">whatsnew</span>
      <span class="ruby-identifier">parse_file</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">read?</span>
      <span class="ruby-identifier">list</span> <span class="ruby-operator">-</span> (<span class="ruby-identifier">filelist</span> <span class="ruby-operator">+</span> [<span class="ruby-identifier">filename</span>])
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="whatsold-method" class="method-detail ">
        <a name="M000033"></a>

        <div class="method-heading">
        
          <span class="method-name">whatsold</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Files listed in the manifest file, but not found in file system.
</p>
          

          
          <div class="method-source-code"
            id="whatsold-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 209</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">whatsold</span>
      <span class="ruby-identifier">parse_file</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">read?</span>
      <span class="ruby-identifier">filelist</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">list</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
    </div>
  
    <div id="private-instance-method-details" class="method-section section">
      <h3 class="section-header">Private Instance Methods</h3>

    
      <div id="checksum-method" class="method-detail ">
        <a name="M000072"></a>

        <div class="method-heading">
        
          <span class="method-name">checksum</span><span
            class="method-args">(file, digest=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Produce hexdigest/cheksum for a file. Default digest type is sha1.
</p>
          

          
          <div class="method-source-code"
            id="checksum-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 433</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">checksum</span>(<span class="ruby-identifier">file</span>, <span class="ruby-identifier">digest</span>=<span class="ruby-keyword kw">nil</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">digest</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">file</span>)
        <span class="ruby-ivar">@null_string</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">digester</span>(<span class="ruby-identifier">digest</span>).<span class="ruby-identifier">hexdigest</span>(<span class="ruby-value str">&quot;&quot;</span>)
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-identifier">digester</span>(<span class="ruby-identifier">digest</span>).<span class="ruby-identifier">hexdigest</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">file</span>))
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="create-temporary-manifest-method" class="method-detail ">
        <a name="M000071"></a>

        <div class="method-heading">
        
          <span class="method-name">create_temporary_manifest</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Create temporary manifest (for comparison).
</p>
          

          
          <div class="method-source-code"
            id="create-temporary-manifest-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 414</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_temporary_manifest</span>
      <span class="ruby-identifier">temp_manifest</span> = <span class="ruby-constant">Manifest</span>.<span class="ruby-identifier">new</span>(
        <span class="ruby-identifier">:file</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">file</span><span class="ruby-operator">+</span><span class="ruby-value str">&quot;~&quot;</span>,
        <span class="ruby-identifier">:digest</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">digest</span>,
        <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">include</span>,
        <span class="ruby-identifier">:exclude</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">exclude</span>,
        <span class="ruby-identifier">:ignore</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ignore</span>,
        <span class="ruby-identifier">:all</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">all</span>
      )
      <span class="ruby-identifier">temp_manifest</span>.<span class="ruby-identifier">save</span>
      <span class="ruby-comment cmt">#File.open(tempfile, 'w+') do |f|</span>
      <span class="ruby-comment cmt">#  f &lt;&lt; to_s(true)</span>
      <span class="ruby-comment cmt">#end</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">temp_manifest</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="digester-method" class="method-detail ">
        <a name="M000073"></a>

        <div class="method-heading">
        
          <span class="method-name">digester</span><span
            class="method-args">(type=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Return a digest class for given <tt>type</tt>. Supported digests are:
</p>
<ul>
<li>md5

</li>
<li>sha1

</li>
<li>sha128 (same as sha1)

</li>
<li>sha256

</li>
<li>sha512

</li>
</ul>
<p>
Default digest type is sha256.
</p>
          

          
          <div class="method-source-code"
            id="digester-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 453</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">digester</span>(<span class="ruby-identifier">type</span>=<span class="ruby-keyword kw">nil</span>)
      <span class="ruby-identifier">require</span> <span class="ruby-value str">'openssl'</span>
      <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'md5'</span>
        <span class="ruby-identifier">require</span> <span class="ruby-value str">'digest/md5'</span>
        <span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'sha128'</span>, <span class="ruby-value str">'sha1'</span>
        <span class="ruby-identifier">require</span> <span class="ruby-value str">'digest/sha1'</span>  <span class="ruby-comment cmt">#need?</span>
        <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'sha256'</span>
        <span class="ruby-identifier">require</span> <span class="ruby-value str">'digest/sha1'</span>  <span class="ruby-comment cmt">#need?</span>
        <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA256</span>
      <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'sha512'</span>
        <span class="ruby-identifier">require</span> <span class="ruby-value str">'digest/sha1'</span>  <span class="ruby-comment cmt">#need?</span>
        <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA512</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;unsupported digest #{type}&quot;</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="exclusions-method" class="method-detail ">
        <a name="M000066"></a>

        <div class="method-heading">
        
          <span class="method-name">exclusions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Compute exclusions.
</p>
          

          
          <div class="method-source-code"
            id="exclusions-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 371</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exclusions</span>
      <span class="ruby-ivar">@_exclusions</span> <span class="ruby-operator">||=</span> (
        <span class="ruby-identifier">e</span>  = [<span class="ruby-identifier">exclude</span>].<span class="ruby-identifier">flatten</span>
        <span class="ruby-identifier">e</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">DEFAULT_EXCLUDE</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">all?</span>
        <span class="ruby-identifier">e</span> <span class="ruby-operator">+=</span> [<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-value str">'~'</span>)] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span>
        <span class="ruby-identifier">e</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">x</span>) }.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>
      )
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="files-method" class="method-detail ">
        <a name="M000064"></a>

        <div class="method-heading">
        
          <span class="method-name">files</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
List of files.
</p>
          

          
          <div class="method-source-code"
            id="files-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 344</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">files</span> <span class="ruby-comment cmt">#(update=false)</span>
      <span class="ruby-ivar">@files</span> <span class="ruby-operator">||=</span> (
        <span class="ruby-identifier">r</span> = []
        <span class="ruby-identifier">output</span>(<span class="ruby-identifier">r</span>)
        <span class="ruby-identifier">r</span>
      )
      <span class="ruby-comment cmt">#files = []</span>
      <span class="ruby-comment cmt">#Dir.chdir(directory) do</span>
      <span class="ruby-comment cmt">#  files += Dir.multiglob_r('**/*')</span>
      <span class="ruby-comment cmt">#  files -= Dir.multiglob_r(exclusions)</span>
      <span class="ruby-comment cmt">#end</span>
      <span class="ruby-comment cmt">#return files</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="ignores-method" class="method-detail ">
        <a name="M000067"></a>

        <div class="method-heading">
        
          <span class="method-name">ignores</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Compute ignores.
</p>
          

          
          <div class="method-source-code"
            id="ignores-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 381</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ignores</span>
      <span class="ruby-ivar">@_ignores</span> <span class="ruby-operator">||=</span> (
        <span class="ruby-identifier">i</span>  = [<span class="ruby-identifier">ignore</span>].<span class="ruby-identifier">flatten</span>
        <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> [ <span class="ruby-value str">'.'</span>, <span class="ruby-value str">'..'</span> ]
        <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">DEFAULT_IGNORE</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">all?</span>
        <span class="ruby-identifier">i</span>
      )
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="inclusions-method" class="method-detail ">
        <a name="M000065"></a>

        <div class="method-heading">
        
          <span class="method-name">inclusions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Compute exclusions.
</p>
          

          
          <div class="method-source-code"
            id="inclusions-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 359</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inclusions</span>
      <span class="ruby-ivar">@_inclusions</span> <span class="ruby-operator">||=</span> (
        <span class="ruby-identifier">e</span>  = [<span class="ruby-identifier">include</span>].<span class="ruby-identifier">flatten</span>
        <span class="ruby-comment cmt">#e += DEFAULT_EXCLUDE unless all?</span>
        <span class="ruby-comment cmt">#e += [filename, filename.chomp('~')] if file</span>
        <span class="ruby-identifier">e</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">x</span>) }.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>
        <span class="ruby-identifier">e</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">reduce</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">e</span>)
        <span class="ruby-identifier">e</span>
      )
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="output-method" class="method-detail ">
        <a name="M000053"></a>

        <div class="method-heading">
        
          <span class="method-name">output</span><span
            class="method-args">(out=$stdout)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="output-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 299</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">output</span>(<span class="ruby-identifier">out</span>=<span class="ruby-identifier">$stdout</span>)
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">directory</span>) <span class="ruby-keyword kw">do</span>
        <span class="ruby-identifier">exclusions</span>  <span class="ruby-comment cmt"># seed exclusions</span>
        <span class="ruby-comment cmt">#rec_output('*', out)</span>
        <span class="ruby-identifier">inclusions</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inc</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">rec_output</span>(<span class="ruby-identifier">inc</span>, <span class="ruby-identifier">out</span>)
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="parse-directory-method" class="method-detail ">
        <a name="M000063"></a>

        <div class="method-heading">
        
          <span class="method-name">parse_directory</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          
          

          
          <div class="method-source-code"
            id="parse-directory-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 334</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_directory</span>
      <span class="ruby-identifier">h</span> = {}
      <span class="ruby-identifier">files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">h</span>[<span class="ruby-identifier">f</span>] = <span class="ruby-identifier">checksum</span>(<span class="ruby-identifier">f</span>)
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">h</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="parse-file-method" class="method-detail ">
        <a name="M000074"></a>

        <div class="method-heading">
        
          <span class="method-name">parse_file</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Read manifest file.
</p>
          

          
          <div class="method-source-code"
            id="parse-file-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 475</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_file</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ManifestMissing</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">file</span>

      <span class="ruby-identifier">parse_topline</span>

      <span class="ruby-comment cmt">#@file = file</span>
      <span class="ruby-comment cmt">#@location = File.dirname(File.expand_path(file))</span>

      <span class="ruby-identifier">chart</span> = {}
      <span class="ruby-identifier">flist</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read_list</span>(<span class="ruby-identifier">file</span>)
      <span class="ruby-identifier">flist</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">left</span>, <span class="ruby-identifier">right</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\s+/</span>)
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">right</span>
          <span class="ruby-identifier">checksum</span> = <span class="ruby-identifier">left</span>
          <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">right</span>
          <span class="ruby-identifier">chart</span>[<span class="ruby-identifier">filename</span>] = <span class="ruby-identifier">checksum</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">left</span>
          <span class="ruby-identifier">chart</span>[<span class="ruby-identifier">filename</span>] = <span class="ruby-keyword kw">nil</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-ivar">@read</span>      = <span class="ruby-keyword kw">true</span>
      <span class="ruby-ivar">@filechart</span> = <span class="ruby-identifier">chart</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="parse-topline-method" class="method-detail ">
        <a name="M000075"></a>

        <div class="method-heading">
        
          <span class="method-name">parse_topline</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Parse topline.
</p>
          

          
          <div class="method-source-code"
            id="parse-topline-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 508</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_topline</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> = <span class="ruby-identifier">read_topline</span>
        <span class="ruby-identifier">argv</span> = <span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">line</span>)
        <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">argv</span>)
        <span class="ruby-identifier">opts</span> = <span class="ruby-constant">GetoptLong</span>.<span class="ruby-identifier">new</span>(
            [ <span class="ruby-value str">'-g'</span>, <span class="ruby-value str">'--digest'</span> , <span class="ruby-constant">GetoptLong</span><span class="ruby-operator">::</span><span class="ruby-constant">REQUIRED_ARGUMENT</span> ],
            [ <span class="ruby-value str">'-x'</span>, <span class="ruby-value str">'--exclude'</span>, <span class="ruby-constant">GetoptLong</span><span class="ruby-operator">::</span><span class="ruby-constant">REQUIRED_ARGUMENT</span> ],
            [ <span class="ruby-value str">'-i'</span>, <span class="ruby-value str">'--ignore'</span> , <span class="ruby-constant">GetoptLong</span><span class="ruby-operator">::</span><span class="ruby-constant">REQUIRED_ARGUMENT</span> ],
            [ <span class="ruby-value str">'-a'</span>, <span class="ruby-value str">'--all'</span>    , <span class="ruby-constant">GetoptLong</span><span class="ruby-operator">::</span><span class="ruby-constant">NO_ARGUMENT</span> ]
        )
        <span class="ruby-identifier">a</span>, <span class="ruby-identifier">d</span>, <span class="ruby-identifier">x</span>, <span class="ruby-identifier">i</span> = <span class="ruby-keyword kw">false</span>, <span class="ruby-keyword kw">nil</span>, [], []
        <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">opt</span>, <span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">opt</span>
          <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'-g'</span><span class="ruby-operator">:</span> <span class="ruby-identifier">d</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">downcase</span>
          <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'-a'</span><span class="ruby-operator">:</span> <span class="ruby-identifier">a</span> = <span class="ruby-keyword kw">true</span>
          <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'-x'</span><span class="ruby-operator">:</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span>
          <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'-i'</span><span class="ruby-operator">:</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>

        <span class="ruby-ivar">@all</span>     = <span class="ruby-identifier">a</span>
        <span class="ruby-ivar">@digest</span>  = <span class="ruby-identifier">d</span>
        <span class="ruby-ivar">@exclude</span> = <span class="ruby-identifier">x</span>
        <span class="ruby-ivar">@ignore</span>  = <span class="ruby-identifier">i</span>
        <span class="ruby-ivar">@include</span> = <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">dup</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="read-topline-method" class="method-detail ">
        <a name="M000076"></a>

        <div class="method-heading">
        
          <span class="method-name">read_topline</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Read topline of MANIFEST file.
</p>
          

          
          <div class="method-source-code"
            id="read-topline-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 538</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_topline</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-comment cmt">#if file = locate(filename)</span>
        <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">s</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readline</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^#!mast\s*(.*?)\n/</span>
            <span class="ruby-identifier">r</span> = <span class="ruby-identifier">$1</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">r</span>
      <span class="ruby-comment cmt">#end</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="rec-output-method" class="method-detail ">
        <a name="M000054"></a>

        <div class="method-heading">
        
          <span class="method-name">rec_output</span><span
            class="method-args">(match, out=$stdout)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Generate listing on the fly.
</p>
          

          
          <div class="method-source-code"
            id="rec-output-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 310</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rec_output</span>(<span class="ruby-identifier">match</span>, <span class="ruby-identifier">out</span>=<span class="ruby-identifier">$stdout</span>)
      <span class="ruby-identifier">out</span>.<span class="ruby-identifier">flush</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">out</span>
      <span class="ruby-comment cmt">#match = (location == dir ? '*' : File.join(dir,'*'))</span>
      <span class="ruby-identifier">files</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">match</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">FNM_DOTMATCH</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">exclusions</span>
      <span class="ruby-comment cmt"># TODO: Is there a more efficient way to reject ignored files?</span>
      <span class="ruby-comment cmt">#files = files.select{ |f| !ignores.any?{ |i| File.fnmatch(i, File.basename(f)) } }</span>
      <span class="ruby-identifier">files</span> = <span class="ruby-identifier">files</span>.<span class="ruby-identifier">reject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ignores</span>.<span class="ruby-identifier">any?</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">fnmatch</span>(<span class="ruby-identifier">i</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">f</span>)) } }
      <span class="ruby-identifier">files</span> = <span class="ruby-identifier">files</span>.<span class="ruby-identifier">sort</span>
      <span class="ruby-identifier">files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">is_dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">file</span>)
        <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">is_dir</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">is_dir</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">dir?</span>)
          <span class="ruby-identifier">sum</span> = <span class="ruby-identifier">checksum</span>(<span class="ruby-identifier">file</span>,<span class="ruby-identifier">digest</span>)
          <span class="ruby-identifier">sum</span> = <span class="ruby-identifier">sum</span> <span class="ruby-operator">+</span> <span class="ruby-value str">' '</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sum</span>
          <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{sum}#{file}&quot;</span>
          <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">out</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_dir</span>
          <span class="ruby-identifier">rec_output</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">file</span>,<span class="ruby-value str">'*'</span>), <span class="ruby-identifier">out</span>)
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-comment cmt">#return out</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
      <div id="topline-string-method" class="method-detail ">
        <a name="M000077"></a>

        <div class="method-heading">
        
          <span class="method-name">topline_string</span><span
            class="method-args">(update=false)</span>
          <span class="method-click-advice">click to toggle source</span>
        
        </div>

        <div class="method-description">
          
          <p>
Create topline of MANIFEST file.
</p>
          

          
          <div class="method-source-code"
            id="topline-string-source">
<pre>
<span class="ruby-comment cmt"># File lib/mast/manifest.rb, line 553</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">topline_string</span>(<span class="ruby-identifier">update</span>=<span class="ruby-keyword kw">false</span>)
      <span class="ruby-comment cmt">#if update</span>
      <span class="ruby-comment cmt">#  a = all #|| topline.all</span>
      <span class="ruby-comment cmt">#  d = digest #|| topline.digest</span>
      <span class="ruby-comment cmt">#  x = exclude #+ topline.exclude</span>
      <span class="ruby-comment cmt">#else</span>
      <span class="ruby-comment cmt">#  a, d, x = all, digest, exclude</span>
      <span class="ruby-comment cmt">#end</span>
      <span class="ruby-identifier">top</span> = []
      <span class="ruby-identifier">top</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;-a&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">all?</span>
      <span class="ruby-identifier">top</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;-g #{digest.to_s.downcase}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">digest</span>
      <span class="ruby-identifier">exclude</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">top</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;-x #{e}&quot;</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">ignore</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">top</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;-i #{e}&quot;</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">include</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">top</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">e</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#!mast #{top.join(' ')}\n&quot;</span>  <span class="ruby-comment cmt"># FIXME: use proper executable</span>
    <span class="ruby-keyword kw">end</span></pre>
          </div>
          
        </div>

        
      </div>

    
    </div>
  

  </div>


  <div id="rdoc-debugging-section-dump" class="debugging-section">
  
    <p>Disabled; run with --debug to generate this.</p>
  
  </div>

</main>
</body>
</html>

